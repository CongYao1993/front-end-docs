import{_ as e,c,o,e as t}from"./app-CCtMo5dT.js";const l="/front-end-docs/assets/websocket-connect-B2FRGD8k.png",i={},s=t('<h2 id="_1-websocket-介绍" tabindex="-1"><a class="header-anchor" href="#_1-websocket-介绍"><span>1. WebSocket 介绍</span></a></h2><p>WebSocket 是应用层的网络通信协议。特点如下：</p><ul><li>支持<strong>客户端与服务器的全双工通信</strong>，服务器可以主动向客户端推送信息，客户端也可以主动向服务器发送信息，能更好地节省服务器资源和带宽并达到实时通讯的目的；</li><li>是一种<strong>持久连接</strong>；</li><li>允许<strong>跨域通信</strong>；</li><li>建立在 TCP 协议之上；</li><li>与 HTTP 协议有着良好的兼容性：默认端口也是 80 和 443，并且握手阶段采用 HTTP 协议，因此握手时不容易屏蔽，能通过各种 HTTP 代理服务器；</li><li>数据格式比较轻量，性能开销小，通信高效；通过第一个请求建立了 TCP 连接之后，之后交换的数据都不需要发送请求头；</li><li>可以发送文本，也可以发送二进制数据；</li><li>协议标识符是 ws（如果加密，则为 wss），服务器网址就是 URL <code>ws://example.com:80/some/path</code>。</li></ul><h2 id="_2-websocket-建立连接" tabindex="-1"><a class="header-anchor" href="#_2-websocket-建立连接"><span>2. WebSocket 建立连接</span></a></h2><img src="'+l+'" width="60%"><ol><li>客户端发起 http 请求，经过 3 次握手，与服务器建立 TCP 连接（HTTP 版本必须是 1.1 以上）；</li><li>发送一个 GET 请求进行协议升级，http 请求头存放 WebSocket 相关信息；</li><li>服务器收到客户端的握手请求后，同样采用 http 协议作出响应；</li><li>在协议升级后，客户端和服务器之间的通信将使用 WebSocket 协议进行而不再是 HTTP，可以在同一个 WebSocket 连接上进行双向通信。</li></ol><p>请求头：</p><ul><li><code>Connection: Upgrade</code>：表示要升级协议</li><li><code>Upgrade: websocket</code>：表示要升级到 Websocket 协议</li><li><code>Sec-WebSocket-Version: 13</code>：表示 Websocket 的版本。如果服务端不支持该版本，需要返回一个 <code>Sec-WebSocket-Versionheader</code>，包含服务端支持的版本号。</li><li><code>Sec-WebSocket-Key: klqqcs6ouTl4HdLM5v7bgw==</code>：与后面服务端响应首部的 <code>Sec-WebSocket-Accept</code> 是配套的，提供基本的防护，比如恶意的连接，或者无意的连接。</li></ul><p>响应头：</p><ul><li><code>Connection: Upgrade</code>：表示要升级协议</li><li><code>Upgrade: websocket</code>：表示要升级到 Websocket 协议</li><li><code>Sec-WebSocket-Accept: kR1cCC0ilB7m2S4czPawig/H4Ek=</code>：根据客户端请求首部的 Sec-WebSocket-Key 计算出来。</li></ul><p>状态代码 101 表示协议切换。到此完成协议升级，后续的数据交互都按照新的协议来。</p><h2 id="_3-websocket-心跳" tabindex="-1"><a class="header-anchor" href="#_3-websocket-心跳"><span>3. WebSocket 心跳</span></a></h2><p>https://www.ruanyifeng.com/blog/2017/05/websocket.html</p>',13),n=[s];function a(d,r){return o(),c("div",null,n)}const b=e(i,[["render",a],["__file","WebSocket.html.vue"]]),p=JSON.parse('{"path":"/interview/%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/WebSocket.html","title":"","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"1. WebSocket 介绍","slug":"_1-websocket-介绍","link":"#_1-websocket-介绍","children":[]},{"level":2,"title":"2. WebSocket 建立连接","slug":"_2-websocket-建立连接","link":"#_2-websocket-建立连接","children":[]},{"level":2,"title":"3. WebSocket 心跳","slug":"_3-websocket-心跳","link":"#_3-websocket-心跳","children":[]}],"git":{"updatedTime":1723989556000,"contributors":[{"name":"yaocong","email":"cong1207@qq.com","commits":1}]},"filePathRelative":"interview/浏览器与计算机网络/WebSocket.md"}');export{b as comp,p as data};
